# PHP-VK-BOT

Личная библиотека для создания ботов и всякой другой херни

___

## Содержание

1. [Установка](#%D0%A3%D1%81%D1%82%D0%B0%D0%BD%D0%BE%D0%B2%D0%BA%D0%B0)
    + [Настройка конфига](#11-настройка-конфига)
2. [Обработка команд](#3-обработка-команд)
    + [Базовые опции](#31-базовые-опции)
        + [Вызов команды при помощи метода](#311-вызов-команды-при-помощи-метода)
        + [Игнорирование вызова команды при помощи метода](#312-игнорирование-вызова-команды-при-помощи-метода)
    + [Расширенные опции](#32-расширенные-опции)
        + [Вариативность вызова команды](#321-вариативность-вызова-команды)
        + [Варианты реагирования бота на сообщения](#322-варианты-реагирования-бота-на-сообщения)
            - [Похоже на](#3221-похоже-на)
            - [Начинается с](#3222-начинается-с)
            - [Заканчивается на](#3223-заканчивается-на)
            - [Содержит](#3224-содержит)
            - [Дополнение](#3225-дополнение)
        + [Исполнение нескольких методов](#323-исполнение-нескольких-методов)
3. [Методы](#4-методы)

___

## 1. Установка

> composer require labile/vk-bot-constructor

### 1.1 Настройка конфига

```json
{
  "auth": {
    "token": "",
    "v": "5.130",
    "confirmation": "",
    "secret": false
  },
  "logging_error": false,
  "type": "callback"
}
```

##### Auth:
    token - access_token сообщества или пользователя
    v - версия используемого api vk
    confirmation - строка, которую должен вернуть сервер для события confirmation
    secret - произвольная строка, которая будет передаваться с каждым запросом (необязательный параметр)

##### Остальные параметры:
    logging_error - логирование ошибок. При значении true все ошибки будут логироваться в папку error
    type - тип работы бота. Возможны только два типа - callback, longpoll


## 3. Обработка команд

### 3.1. Базовые опции

#### 3.1.3. Реакция не предложения или другие слова

Если хотите сделать реакцию на предложения, то отредактируйте метод **text()** в CommandList.

```php
protected function text()  
{  
        return [

            [
                'text' => ['pr', 'print'],
                'method' => ['print']
            ],

            [
                'text' => ['блин', 'капец'],
                'method' => ['blin']
            ],

        ];
}
 ```

#### 3.1.4. Реакция на нажатие по кнопке
Реакция создаётся аналогичной выше, только метод **payload()**

```php
protected function payload()  
{  
        return [
            
            'chat' =>
                [
                    [
                        'payload' => 'registration',
                        'method' => ['chatRegistration'],
                        'type' => 'default'
                    ],

                ],

        ];
}
 ```

```php
Payload соответствующий команде выше:
['chat' => 'registration]

type - тип кнопки, callback или default
```


### 3.2. Расширенные опции

#### 3.2.1. Вариативность вызова команды

Если указать ключ **text** как массив, то бот будет реагировать на несколько фраз.

```php
'text'=>['text message 1', 'text message 2']
```

#### 3.2.2. Варианты реагирования бота на сообщения.

Вы можете вызывать команду разными вариантами:

- Похоже на
- Начинается с
- Заканчивается на
- Содержит

##### 3.2.2.1. Похоже на

Чтобы использовать этот вариант, добавьте **|** в начале строки.

Вы можете настроить вероятность совпадения в диапазоне [0-100].

Установить эту настройку можно в **Launcher.php** отредактировав константу: **SIMILAR_PERCENT**.

По умолчанию: 80%.

```php
'text'=>'|привет всем',
```

##### 3.2.2.2. Начинается с

Чтобы использовать этот вариант, добавьте **[|** в начале строки.

```php
'text'=>'[|привет всем',
```

##### 3.2.2.3. Заканчивается на

Чтобы использовать этот вариант, добавьте **|]** в конец строки.

```php
'text'=>'привет всем|]',
```

##### 3.2.2.4. Содержит

Чтобы использовать этот вариант, выделите фразу в фигурных скобках **{ фраза }**.

```php
'text'=>'{привет всем}',
```

##### 3.2.2.5. Дополнение

Данный способ работает и с использованием множества вариантов вызова.

```php
'text'=>['[|привет', '{ку}', 'хай|]', '|здравствуйте']
```

#### 3.2.3. Исполнение нескольких методов

Если указать ключ **method** как массив, то бот будет выполнять указанные методы по очереди.

```php
'method'=>['hello', 'goodbye']
```

## 4. Методы

#### Используются методы из SimpleVK

```php
protected function hello()  
{  
   $vk->msg('Привет, ~!fn~')->send();
}
```

[Примеры можно глянуть здесь](https://simplevk.scripthub.ru/v3/classes/simplevk.html)